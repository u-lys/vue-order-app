{"remainingRequest":"D:\\第四阶段\\vue_app_000\\vue_app_00\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\第四阶段\\vue_app_000\\vue_app_00\\src\\components\\view\\Carts.vue?vue&type=style&index=0&id=e2c751a8&scoped=true&lang=css","dependencies":[{"path":"D:\\第四阶段\\vue_app_000\\vue_app_00\\src\\components\\view\\Carts.vue","mtime":1568638906710},{"path":"D:\\第四阶段\\vue_app_000\\vue_app_00\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"D:\\第四阶段\\vue_app_000\\vue_app_00\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1521907988000},{"path":"D:\\第四阶段\\vue_app_000\\vue_app_00\\node_modules\\postcss-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\第四阶段\\vue_app_000\\vue_app_00\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1534853416000},{"path":"D:\\第四阶段\\vue_app_000\\vue_app_00\\node_modules\\vue-loader\\lib\\index.js","mtime":1527860006000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n /* 商品信息 */\n .cart-item{\n   display: flex;\n   flex-wrap: wrap;\n   justify-content:space-between;\n   align-items: center;\n   border-bottom: 1px solid #ccc;\n   margin-top: 25px;\n }\n .leftText{\n   display: flex;\n   align-items: center;\n }\n .lname{\n   margin-left: 25px;\n }\n .price{\n   margin-left: 25px;\n }\n input[type=checkbox]{\n   display: inline-block;\n   margin-top:4px;\n }\n.selectAll .all{\n   display:block;\n   margin-top:-14px;\n   margin-left:45px;\n }\n button{\n   margin-left: 10px;\n }\n span{\n   margin-left: 8px;\n }\n",{"version":3,"sources":["Carts.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Carts.vue","sourceRoot":"src\\components\\view","sourcesContent":["<template>\r\n <div class=\"carts\">\r\n   <!-- 全选 -->\r\n    <div class=\"selectAll\">\r\n      全选 <input class=\"all\" type=\"checkbox\"  @click=\"selectAll\" v-model=\"isCheck\" />\r\n    </div>\r\n    <!-- 商品信息 -->\r\n    <div class=\"cart-item\" v-for=\"(item,index) of list\" :key=\"index\">\r\n      <div class=\"leftText\">\r\n        <input type=\"checkbox\" v-model=\"checklist\" :checked=\"item.checked\" :value=\"item.id\"/>\r\n        <img :src=\"'http://127.0.0.1:8080/'+item.img_url\">\r\n        <div class=\"lname\">{{item.lname}}</div>\r\n        <div class=\"price\">{{item.price}}</div>\r\n        <button @click=\"btnsFn\"  :data-count=\"item.count\"\r\n        :data-n=\"-1\"\r\n        :data-id=\"item.id\">-</button>\r\n        <span>{{item.count}}</span>\r\n        <button @click=\"btnsFn\"  :data-count=\"item.count\" :data-n=\"+1\" :data-id=\"item.id\">+</button>\r\n      </div>\r\n      <mt-button @click=\"deleteItem\" :data-id=\"item.id\">删除</mt-button>\r\n    </div>\r\n    <!-- 删除、清空购物车 -->\r\n    <div>\r\n      总数量:<span style=\"color:red;margin-left:5px;\">{{count}}</span>\r\n      合计\r\n      <span style=\"color:red;margin-left:5px\" >￥{{total}}</span>\r\n      <mt-button @click=\"deleteItems\">删除选中商品</mt-button>\r\n      <mt-button @click=\"clearAll\">清空购物车</mt-button>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      list:[],\r\n      count:0,\r\n      sum:0,\r\n      checklist:[],\r\n      isCheck:false,\r\n      num:[], \r\n    }\r\n  },\r\n  created() {\r\n    this.load()\r\n    this.allCount()\r\n    this.total()\r\n  },\r\n  watch: {\r\n    checklist:function(val){\r\n      // console.log(val);\r\n      // console.log(this.list.length);\r\n      if(val.length==this.list.length){\r\n        this.isCheck=true\r\n      }else{\r\n        this.isCheck=false;\r\n        \r\n      }\r\n    }\r\n  },\r\n  computed:{\r\n    \r\n  },\r\n  methods: {\r\n    load(){\r\n      var url=\"carts\"\r\n      this.axios.get(url).then(result=>{\r\n        if(result.data.code==-1){\r\n          this.$messagebox(\"消息\",\"请先登录\").then(res=>{\r\n            this.$router.push(\"/userLogin\");\r\n          });\r\n        }\r\n        var rows=result.data;\r\n        //循环遍历result.data中的数据\r\n        for(var item of rows){\r\n          //为cb添加新属值false\r\n          item.checked=false;\r\n        }\r\n        this.list=rows;\r\n      });\r\n      console.log(\"购物车列表\")\r\n    },\r\n    total(){\r\n      var t=0;\r\n      for(var item of this.list){\r\n        if(item.checked==true){\r\n          t+=parseInt(item.price*item.count);\r\n          this.sum=t;\r\n        }\r\n      }\r\n    },\r\n    deleteItem(event){\r\n      this.$messagebox.confirm(\"是否删除商品\").then(res=>{\r\n        var  id=event.target.dataset.id;\r\n        var obj={\r\n          params:{id}\r\n        }\r\n        this.axios.get(\r\n        \"delItem\",obj\r\n        ).then(result=>{\r\n          this.load();\r\n          this.allCount();\r\n        });\r\n      }).catch(err=>{\r\n        if(err) throw err;\r\n      })\r\n    },\r\n    deleteItems(event){\r\n      this.$messagebox.confirm(\"是否删除选中商品\").then(res=>{\r\n        //1、保存选中id\r\n        var id=\"\";\r\n        //2、循环遍历数组中每一个元素\r\n        for(var item of this.list){\r\n        //3、判断cb是否为true \r\n          if(item.cb==true){\r\n            //4、拼接id\r\n            id+=item.id+\",\";\r\n          }\r\n        }\r\n        //5、去除字符串最后一个，\r\n        id=id.slice(0,-1);\r\n        //6、判断用户是否选中商品\r\n        if(id==\"\"){\r\n          this.$toast(\"请选择你要删除的商品\");\r\n          return;\r\n        }\r\n        var url=\"delItems\";\r\n        var obj={\r\n          params:{id}\r\n        }\r\n        //发送ajax请求\r\n        this.axios.get(url,obj).then(result=>{\r\n          if(result.data.code==-1){\r\n            this.$toast(\"删除失败\")\r\n          }else{\r\n            this.$toast(\"删除成功\")\r\n            this.load();\r\n            this.allCount();\r\n          }\r\n        });\r\n      }).catch(err=>{\r\n        if(err) throw err;\r\n      })\r\n    },\r\n    clearAll(){\r\n      this.axios.get(\"clear\").then(result=>{\r\n        this.load();\r\n        this.allCount();\r\n      });\r\n    },\r\n    selectAll(){ \r\n      if(!this.isCheck){\r\n        //选中状态\r\n        for(var item of this.list){\r\n          this.checklist.push(item.id);\r\n        }\r\n      }else{\r\n        this.checklist=[];\r\n      }\r\n    },\r\n    allCount(){\r\n      this.axios.get(\"getCount\").then(result=>{\r\n        if(result.data.code==1){\r\n          var  count=result.data.data;\r\n          this.count=count;\r\n        }\r\n      })\r\n    },\r\n    btnsFn(event){\r\n      var id=event.target.dataset.id;\r\n      var count=event.target.dataset.count;\r\n      var n=event.target.dataset.n;\r\n      var obj = {id,count};\r\n      if(count>=1){\r\n\r\n      }\r\n    },\r\n    checkInput(event){\r\n      var selectAll=document.querySelector(\r\n        \".selectAll input\"\r\n      );\r\n      //\r\n      var price=parseInt(event.target.dataset.price);\r\n      var input=event.target;\r\n      var span=input.parentNode.children[5];\r\n      //获取数量\r\n      var n=parseInt(span.innerHTML);\r\n      if(event.target.checked==true){\r\n        if(document.querySelector(\".leftText input:not(:checked)\")==null){\r\n        //才修改全选按钮为选中\r\n\t\t\t\tselectAll.checked=true;\r\n\t\t\t}\r\n        this.sum+=parseInt(price*n);\r\n      }else{\r\n        selectAll.checked=false;\r\n        this.sum-=parseInt(price*n);\r\n      }\r\n    },\r\n    updCount(html,lid){\r\n      var obj={\r\n        params:{html,lid}\r\n      }\r\n      this.axios.get(\"updcount\",obj).then(result=>{\r\n        \r\n      }).catch(err=>{\r\n        console.log(err);\r\n      });\r\n    }\r\n  }, \r\n}\r\n</script>\r\n<style scoped>\r\n  /* 商品信息 */\r\n  .cart-item{\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    justify-content:space-between;\r\n    align-items: center;\r\n    border-bottom: 1px solid #ccc;\r\n    margin-top: 25px;\r\n  }\r\n  .leftText{\r\n    display: flex;\r\n    align-items: center;\r\n  }\r\n  .lname{\r\n    margin-left: 25px;\r\n  }\r\n  .price{\r\n    margin-left: 25px;\r\n  }\r\n  input[type=checkbox]{\r\n    display: inline-block;\r\n    margin-top:4px;\r\n  }\r\n .selectAll .all{\r\n    display:block;\r\n    margin-top:-14px;\r\n    margin-left:45px;\r\n  }\r\n  button{\r\n    margin-left: 10px;\r\n  }\r\n  span{\r\n    margin-left: 8px;\r\n  }\r\n</style>"]}]}