{"remainingRequest":"C:\\vue_team_app\\vue_team_app\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\vue_team_app\\vue_team_app\\src\\components\\view\\Cart.vue?vue&type=style&index=0&id=468be4d7&scoped=true&lang=css","dependencies":[{"path":"C:\\vue_team_app\\vue_team_app\\src\\components\\view\\Cart.vue","mtime":1568638916235},{"path":"C:\\vue_team_app\\vue_team_app\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"C:\\vue_team_app\\vue_team_app\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1521907988000},{"path":"C:\\vue_team_app\\vue_team_app\\node_modules\\postcss-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\vue_team_app\\vue_team_app\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1534853416000},{"path":"C:\\vue_team_app\\vue_team_app\\node_modules\\vue-loader\\lib\\index.js","mtime":1527860006000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n /* 商品信息 */\n .cart-item{\n   display: flex;\n   flex-wrap: wrap;\n   justify-content:space-between;\n   align-items: center;\n   border-bottom: 1px solid #ccc;\n   margin-top: 25px;\n }\n .leftText{\n   display: flex;\n   align-items: center;\n }\n .lname{\n   margin-left: 25px;\n }\n .price{\n   margin-left: 25px;\n }\n input[type=checkbox]{\n   display: inline-block;\n   margin-top:4px;\n }\n.selectAll .all{\n   display:block;\n   margin-top:-14px;\n   margin-left:45px;\n }\n button{\n   margin-left: 10px;\n }\n span{\n   margin-left: 8px;\n }\n \n",{"version":3,"sources":["Cart.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Cart.vue","sourceRoot":"src\\components\\view","sourcesContent":["<template>\r\n <div class=\"carts\">\r\n   <!-- 全选 -->\r\n    <div class=\"selectAll\">\r\n      全选 <input class=\"all\" type=\"checkbox\"  @click=\"selectAll\" />\r\n    </div>\r\n    <!-- 商品信息 -->\r\n    <div class=\"cart-item\" v-for=\"(item,index) of list\" :key=\"index\">\r\n      <div class=\"leftText\">\r\n        <input type=\"checkbox\" v-model=\"item.cb\" @click=\"checkInput\" :data-price=\"item.price\"/>\r\n        <img :src=\"'http://127.0.0.1:8080/'+item.img_url\">\r\n        <div class=\"lname\">{{item.lname}}</div>\r\n       \r\n        <div class=\"price\">{{item.price}}</div>\r\n        <button @click=\"btnsFn\"  :data-cb=\"item.cb\" :data-lid=\"item.lid\">-</button>\r\n        <span>{{item.count}}</span>\r\n        <button @click=\"btnsFn\" :data-cb=\"item.cb\" :data-lid=\"item.lid\">+</button>\r\n      </div>\r\n      <mt-button @click=\"deleteItem\" :data-id=\"item.id\">删除</mt-button>\r\n    </div>\r\n    <!-- 删除、清空购物车 -->\r\n    <div>\r\n      总数量:<span style=\"color:red;margin-left:5px;\">{{count}}</span>\r\n      合计\r\n      <span style=\"color:red;margin-left:5px\" >{{sum}}</span>\r\n      <mt-button @click=\"deleteItems\">删除选中商品</mt-button>\r\n      <mt-button @click=\"clearAll\">清空购物车</mt-button>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      list:[],\r\n      count:0,\r\n      sum:0,\r\n      checklist:[],\r\n      isCheck:false,\r\n      num:[], \r\n    }\r\n  },\r\n  created() {\r\n    this.load()\r\n    this.allCount()\r\n  },\r\n  methods: {\r\n    load(){\r\n      var url=\"carts\"\r\n      this.axios.get(url).then(result=>{\r\n        if(result.data.code==-1){\r\n          this.$messagebox(\"消息\",\"请先登录\").then(res=>{\r\n            this.$router.push(\"/userLogin\");\r\n          });\r\n        }\r\n        var rows=result.data;\r\n        //循环遍历result.data中的数据\r\n        for(var item of rows){\r\n          //为cb添加新属值false\r\n          item.cb=false;\r\n        }\r\n        this.list=rows;\r\n      });\r\n      console.log(\"购物车列表\")\r\n    },\r\n    deleteItem(event){\r\n      this.$messagebox.confirm(\"是否删除商品\").then(res=>{\r\n        var  id=event.target.dataset.id;\r\n        var obj={\r\n          params:{id}\r\n        }\r\n        this.axios.get(\r\n        \"delItem\",obj\r\n        ).then(result=>{\r\n          this.load();\r\n          this.allCount();\r\n        });\r\n      }).catch(err=>{\r\n        if(err) throw err;\r\n      })\r\n    },\r\n    deleteItems(event){\r\n      this.$messagebox.confirm(\"是否删除选中商品\").then(res=>{\r\n        //1、保存选中id\r\n        var id=\"\";\r\n        //2、循环遍历数组中每一个元素\r\n        for(var item of this.list){\r\n        //3、判断cb是否为true \r\n          if(item.cb==true){\r\n            //4、拼接id\r\n            id+=item.id+\",\";\r\n          }\r\n        }\r\n        //5、去除字符串最后一个，\r\n        id=id.slice(0,-1);\r\n        //6、判断用户是否选中商品\r\n        if(id==\"\"){\r\n          this.$toast(\"请选择你要删除的商品\");\r\n          return;\r\n        }\r\n        var url=\"delItems\";\r\n        var obj={\r\n          params:{id}\r\n        }\r\n        //发送ajax请求\r\n        this.axios.get(url,obj).then(result=>{\r\n          if(result.data.code==-1){\r\n            this.$toast(\"删除失败\")\r\n          }else{\r\n            this.$toast(\"删除成功\")\r\n            this.load();\r\n            this.allCount();\r\n          }\r\n        });\r\n      }).catch(err=>{\r\n        if(err) throw err;\r\n      })\r\n    },\r\n    clearAll(){\r\n      this.axios.get(\"clear\").then(result=>{\r\n        this.load();\r\n        this.allCount();\r\n      });\r\n    },\r\n    selectAll(event){ \r\n      this.axios.get(\"itemcount\").then(result=>{\r\n        var counts=result.data;\r\n        var total=0;\r\n        var cb=event.target.checked;\r\n        this.num=counts;\r\n        var itemCount={};\r\n        for(var obj of this.num){\r\n          obj.cb=false;\r\n          if(cb==true){\r\n            //总计\r\n            total+=obj.price*obj.count;\r\n          }\r\n        }\r\n        for(var item of this.list){\r\n          item.cb=cb;\r\n          if(cb==true){\r\n            this.sum=total; \r\n          }else{\r\n            total=0;\r\n            this.sum=total; \r\n          }\r\n        }\r\n      })   \r\n    },\r\n    allCount(){\r\n      this.axios.get(\"getCount\").then(result=>{\r\n        if(result.data.code==1){\r\n          var  count=result.data.data;\r\n          this.count=count;\r\n        }\r\n      })\r\n    },\r\n    btnsFn(event){\r\n      if(event.target.nodeName==\"BUTTON\"){\r\n        var btns=event.target;\r\n        var lid=event.target.dataset.lid;\r\n        var html=btns.innerHTML;\r\n       //获取span元素内容\r\n        var span=btns.parentNode\r\n          .children[5];\r\n        var n=parseInt(span.innerHTML);\r\n        if(btns.innerHTML==\"+\"){\r\n          n+=1;\r\n          this.updCount(html,lid);\r\n          this.allCount();\r\n        }else if(n>1){\r\n          n-=1;//span的内容就-1\r\n          this.updCount(html,lid);\r\n          this.allCount();\r\n        }else if(n==1){\r\n          n=1;\r\n          this.$toast(\"该宝贝不能再减了哟\");\r\n          return;\r\n        }\r\n        span.innerHTML=n;\r\n        this.allCount();\r\n        //获取单价\r\n        var price=parseInt(btns.parentNode\r\n          .children[3].innerHTML);\r\n        //判断是否选中\r\n        var cb=event.target.dataset.cb;\r\n        //获取小计的和\r\n        // var total=this.sum;\r\n        if(cb){\r\n          if(btns.innerHTML==\"+\"){\r\n             this.sum=this.sum+price;\r\n          }else if(n>=1){\r\n            this.sum=this.sum-price;\r\n          }\r\n        }\r\n      }\r\n    },\r\n    checkInput(event){\r\n      var selectAll=document.querySelector(\r\n        \".selectAll input\"\r\n      );\r\n      //\r\n      var price=parseInt(event.target.dataset.price);\r\n      var input=event.target;\r\n      var span=input.parentNode.children[5];\r\n      //获取数量\r\n      var n=parseInt(span.innerHTML);\r\n      if(event.target.checked==true){\r\n        if(document.querySelector(\".leftText input:not(:checked)\")==null){\r\n        //才修改全选按钮为选中\r\n\t\t\t\tselectAll.checked=true;\r\n\t\t\t}\r\n        this.sum+=parseInt(price*n);\r\n      }else{\r\n        selectAll.checked=false;\r\n        this.sum-=parseInt(price*n);\r\n      }\r\n    },\r\n    updCount(html,lid){\r\n      var obj={\r\n        params:{html,lid}\r\n      }\r\n      this.axios.get(\"updcount\",obj).then(result=>{\r\n        \r\n      }).catch(err=>{\r\n        console.log(err);\r\n      });\r\n    }\r\n  }, \r\n}\r\n</script>\r\n<style scoped>\r\n  /* 商品信息 */\r\n  .cart-item{\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    justify-content:space-between;\r\n    align-items: center;\r\n    border-bottom: 1px solid #ccc;\r\n    margin-top: 25px;\r\n  }\r\n  .leftText{\r\n    display: flex;\r\n    align-items: center;\r\n  }\r\n  .lname{\r\n    margin-left: 25px;\r\n  }\r\n  .price{\r\n    margin-left: 25px;\r\n  }\r\n  input[type=checkbox]{\r\n    display: inline-block;\r\n    margin-top:4px;\r\n  }\r\n .selectAll .all{\r\n    display:block;\r\n    margin-top:-14px;\r\n    margin-left:45px;\r\n  }\r\n  button{\r\n    margin-left: 10px;\r\n  }\r\n  span{\r\n    margin-left: 8px;\r\n  }\r\n  \r\n</style>"]}]}